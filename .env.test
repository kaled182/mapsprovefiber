# ====================================================
# üß™  MAPSPROVEFIBER ‚Äî CONFIGURA√á√ÉO DE TESTES
# ====================================================

# ----------------------------------------------------
# üîß Django Core & Identifica√ß√£o
# ----------------------------------------------------
DJANGO_SETTINGS_MODULE=settings.test
DEBUG=False
TESTING=True
SECRET_KEY=test-key-only-for-testing-do-not-use-in-production

# Metadados da aplica√ß√£o
APP_NAME=mapsprovefiber
APP_ENVIRONMENT=test
APP_VERSION=v1.0.0-test
DEPLOYMENT_ID=test-${CI_COMMIT_SHA:-local}

# ----------------------------------------------------
# üóÑÔ∏è Banco de Dados (SQLite em mem√≥ria)
# ----------------------------------------------------
DB_ENGINE=sqlite
DB_NAME=:memory:

# Opcional: MySQL para testes de integra√ß√£o
# DB_ENGINE=mysql
# DB_NAME=test_mapsprovefiber
# DB_HOST=localhost
# DB_USER=test_user
# DB_PASSWORD=test_pass

# ----------------------------------------------------
# ‚öôÔ∏è Cache (LocMem para isolamento)
# ----------------------------------------------------
REDIS_URL=
CACHE_BACKEND=django.core.cache.backends.locmem.LocMemCache
CACHE_LOCATION=test-cache

# ----------------------------------------------------
# ‚úâÔ∏è E-mail (LocMem para captura)
# ----------------------------------------------------
EMAIL_BACKEND=django.core.mail.backends.locmem.EmailBackend
EMAIL_FILE_PATH=/tmp/django-test-emails
DEFAULT_FROM_EMAIL=test@mapsprovefiber.local

# ----------------------------------------------------
# üß© Logging (Silencioso para output limpo)
# ----------------------------------------------------
LOG_LEVEL=CRITICAL
DJANGO_LOG_LEVEL=CRITICAL
LOG_FORMAT=plain

# Para debug de testes espec√≠ficos
# LOG_LEVEL=DEBUG
# DJANGO_LOG_LEVEL=INFO

# ----------------------------------------------------
# ‚ö° Celery (S√≠ncrono para testes)
# ----------------------------------------------------
CELERY_TASK_ALWAYS_EAGER=true
CELERY_TASK_EAGER_PROPAGATES=true
CELERY_BROKER_URL=memory://
CELERY_RESULT_BACKEND=cache+memory://

# ----------------------------------------------------
# üîí Seguran√ßa (Relaxada para testes)
# ----------------------------------------------------
CSRF_TRUSTED_ORIGINS=http://localhost,http://127.0.0.1
ALLOWED_HOSTS=localhost,127.0.0.1,testserver
USE_X_FORWARDED_HOST=false
SECURE_SSL_REDIRECT=false
SESSION_COOKIE_SECURE=false
CSRF_COOKIE_SECURE=false

# ----------------------------------------------------
# üß± Storage & Files
# ----------------------------------------------------
STATIC_ROOT=/tmp/staticfiles_test
MEDIA_ROOT=/tmp/media_test
DATA_UPLOAD_MAX_MEMORY_SIZE=5242880    # 5MB
FILE_UPLOAD_MAX_MEMORY_SIZE=5242880
FILE_UPLOAD_TEMP_DIR=/tmp/uploads_test

# ----------------------------------------------------
# üß† Sentry (Desativado)
# ----------------------------------------------------
SENTRY_DSN=
SENTRY_ENVIRONMENT=test
SENTRY_TRACES_SAMPLE_RATE=0.0
SENTRY_PROFILES_SAMPLE_RATE=0.0
SENTRY_SEND_PII=false

# ----------------------------------------------------
# üöÄ Health & Monitoring (Mock)
# ----------------------------------------------------
HEALTHCHECK_PATH=/ready
HEALTHCHECK_INTERVAL=5
HEALTHCHECK_TIMEOUT=3
HEALTHCHECK_DB_TIMEOUT=2
HEALTHCHECK_REDIS_TIMEOUT=1

# ----------------------------------------------------
# ‚ö° Performance de Testes
# ----------------------------------------------------

# Password hashing mais r√°pido
PASSWORD_HASHERS=django.contrib.auth.hashers.MD5PasswordHasher

# Test parallelization
TEST_PARALLEL=auto
TEST_RUNNER=django.test.runner.DiscoverRunner

# Migrations (mais r√°pido sem migra√ß√µes)
TEST_DISABLE_MIGRATIONS=true
TEST_MIGRATE=false

# ----------------------------------------------------
# üé≠ Mocks de Servi√ßos Externos
# ----------------------------------------------------

# Zabbix API
ZABBIX_API_URL=http://testserver/mock-zabbix
ZABBIX_API_USER=test_user
ZABBIX_API_PASSWORD=test_pass
ZABBIX_MOCK_RESPONSES=true

# Maps/Geolocation
MAPS_API_KEY=test-mock-maps-api-key
GEOCODING_TIMEOUT=1
ROUTING_TIMEOUT=2
MAPS_MOCK_RESPONSES=true

# ----------------------------------------------------
# üß™ Pytest & Testing Framework
# ----------------------------------------------------
PYTEST_ADDOPTS=-v --tb=short --strict-markers --strict-config -x
PYTEST_MARKERS=slow,integration,unit,db,celery,zabbix,maps
PYTEST_MINIMAL=false

# Coverage
COVERAGE_ENABLED=true
COVERAGE_MIN_PERCENTAGE=80
COVERAGE_REPORT_FORMAT=html,term,xml
COVERAGE_SOURCE=core,maps_view,routes_builder,setup_app,zabbix_api

# ----------------------------------------------------
# üî¨ Desenvolvimento de Testes
# ----------------------------------------------------
TEST_VERBOSITY=1
TEST_DEBUG=false
TEST_KEEP_TEMP=false
TEST_PRESERVE_DB=false

# Factory configurations
FACTORY_BOY_DEFAULT_STRATEGY=build

# ----------------------------------------------------
# üß∞ Ambiente & Runtime
# ----------------------------------------------------
TZ=UTC
PYTHONUNBUFFERED=1
PYTHONHASHSEED=random

# Para debug de tests
# PYTHONBREAKPOINT=pudb.set_trace